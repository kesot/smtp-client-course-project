\hypertarget{protocol_8h}{\subsection{Файл include/protocol.h}
\label{protocol_8h}\index{include/protocol.\-h@{include/protocol.\-h}}
}


Файл содержащий структуры и функции для работы по протоколу S\-M\-T\-P.  


\subsubsection*{Структуры данных}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structmx__conn}{mx\-\_\-conn}
\item 
struct \hyperlink{structdomain}{domain}
\end{DoxyCompactItemize}
\subsubsection*{Функции}
\begin{DoxyCompactItemize}
\item 
\hypertarget{protocol_8h_a6eee60cb94c7f9c2aa01785d478f2d5a}{{\bfseries T\-A\-I\-L\-Q\-\_\-\-H\-E\-A\-D} (mx\-\_\-conn\-\_\-list, \hyperlink{structmx__conn}{mx\-\_\-conn})}\label{protocol_8h_a6eee60cb94c7f9c2aa01785d478f2d5a}

\item 
\hypertarget{protocol_8h_a164d15a8b3fc169a08768a90d9ccf2b1}{{\bfseries T\-A\-I\-L\-Q\-\_\-\-H\-E\-A\-D} (domain\-\_\-set, \hyperlink{structdomain}{domain})}\label{protocol_8h_a164d15a8b3fc169a08768a90d9ccf2b1}

\item 
\hypertarget{protocol_8h_a21cc93a4b19d0b161ab7ddc0db847768}{int \hyperlink{protocol_8h_a21cc93a4b19d0b161ab7ddc0db847768}{smtp\-\_\-client\-\_\-loop} ()}\label{protocol_8h_a21cc93a4b19d0b161ab7ddc0db847768}

\begin{DoxyCompactList}\small\item\em Основная функция, которая мониторит директорию с почтой, чтобы ее отправить \end{DoxyCompactList}\item 
\hypertarget{protocol_8h_a9bd22b876331743b1b7ea35bc202ac3d}{int \hyperlink{protocol_8h_a9bd22b876331743b1b7ea35bc202ac3d}{conn\-\_\-init} ()}\label{protocol_8h_a9bd22b876331743b1b7ea35bc202ac3d}

\begin{DoxyCompactList}\small\item\em Initialize structures for connections with several S\-M\-T\-P servers. \end{DoxyCompactList}\item 
\hypertarget{protocol_8h_a79bd91966c052d0350da3af975e901f7}{void {\bfseries conn\-\_\-loop} ()}\label{protocol_8h_a79bd91966c052d0350da3af975e901f7}

\item 
\hypertarget{protocol_8h_ae6de6df669448d5fe834197125c63018}{int \hyperlink{protocol_8h_ae6de6df669448d5fe834197125c63018}{conn\-\_\-final} ()}\label{protocol_8h_ae6de6df669448d5fe834197125c63018}

\begin{DoxyCompactList}\small\item\em Frees all structures used in mail transfer. \end{DoxyCompactList}\item 
void \hyperlink{protocol_8h_a63b0324a5f0d042dab0ee3c372b73c2b}{domain\-\_\-add} (struct domain\-\_\-set $\ast$domains, char $\ast$new\-\_\-domain\-\_\-name)
\begin{DoxyCompactList}\small\item\em Adds another domain into domain set if it is not present there and if it is not local domain (M\-Y\-\_\-\-D\-O\-M\-A\-I\-N in \hyperlink{maildir_8h}{maildir.\-h}) \end{DoxyCompactList}\item 
\hypertarget{protocol_8h_a2678d96b53074a15c6b7ada9fd7e274b}{int {\bfseries rcpt\-\_\-is\-\_\-from\-\_\-domain} (struct \hyperlink{structrcpt}{rcpt} $\ast$r, struct \hyperlink{structdomain}{domain} $\ast$d)}\label{protocol_8h_a2678d96b53074a15c6b7ada9fd7e274b}

\item 
\hypertarget{protocol_8h_a3e6be25d869e115193d1b0d5cde9ad07}{int {\bfseries mail\-\_\-has\-\_\-rcpts\-\_\-from\-\_\-domain} (struct \hyperlink{structmail}{mail} $\ast$m, struct \hyperlink{structdomain}{domain} $\ast$d)}\label{protocol_8h_a3e6be25d869e115193d1b0d5cde9ad07}

\item 
\hypertarget{protocol_8h_a9ed99410a3642cb510821f00078e836c}{int {\bfseries check\-\_\-dns} (char $\ast$d, char $\ast$output\-\_\-address)}\label{protocol_8h_a9ed99410a3642cb510821f00078e836c}

\item 
\hypertarget{protocol_8h_a25299c3335401ec40597d96a2df0bcbc}{struct \hyperlink{structmx__conn}{mx\-\_\-conn} $\ast$ {\bfseries create\-\_\-connection} (struct \hyperlink{structdomain}{domain} $\ast$dom)}\label{protocol_8h_a25299c3335401ec40597d96a2df0bcbc}

\item 
\hypertarget{protocol_8h_a001371cf331cd6ea30938cf006b8d3da}{struct \hyperlink{structmx__conn}{mx\-\_\-conn} $\ast$ {\bfseries get\-\_\-conn\-\_\-by\-\_\-socket} (struct mx\-\_\-conn\-\_\-list $\ast$cl, int sock)}\label{protocol_8h_a001371cf331cd6ea30938cf006b8d3da}

\item 
\hypertarget{protocol_8h_a9c29bf6383c84c0b734d3b37144482cc}{int {\bfseries wait\-\_\-for\-\_\-response} ()}\label{protocol_8h_a9c29bf6383c84c0b734d3b37144482cc}

\item 
\hypertarget{protocol_8h_a65e032c3158ec7a8f167cd283cbef59c}{int {\bfseries parse\-\_\-response} (struct \hyperlink{structmx__conn}{mx\-\_\-conn} $\ast$conn, char $\ast$str, int length)}\label{protocol_8h_a65e032c3158ec7a8f167cd283cbef59c}

\item 
\hypertarget{protocol_8h_aafcf74851e51a77bff23afc1736df4b3}{void {\bfseries invalidate\-\_\-connection} (struct \hyperlink{structmx__conn}{mx\-\_\-conn} $\ast$conn)}\label{protocol_8h_aafcf74851e51a77bff23afc1736df4b3}

\item 
\hypertarget{protocol_8h_a6f3dd652b874d52d3ce7f2486540ce48}{int {\bfseries send\-\_\-hello} (struct \hyperlink{structmx__conn}{mx\-\_\-conn} $\ast$conn)}\label{protocol_8h_a6f3dd652b874d52d3ce7f2486540ce48}

\item 
\hypertarget{protocol_8h_a8b10f5e2dc31026fd53ca4754c9cceea}{int {\bfseries send\-\_\-mailfrom} (struct \hyperlink{structmx__conn}{mx\-\_\-conn} $\ast$conn)}\label{protocol_8h_a8b10f5e2dc31026fd53ca4754c9cceea}

\item 
\hypertarget{protocol_8h_a0f46c7536b8a12e73de1883b196696b5}{int {\bfseries send\-\_\-rcptto} (struct \hyperlink{structmx__conn}{mx\-\_\-conn} $\ast$conn)}\label{protocol_8h_a0f46c7536b8a12e73de1883b196696b5}

\item 
\hypertarget{protocol_8h_a7f08ff74d834d14d6aaf5b6d19b99085}{int {\bfseries send\-\_\-data} (struct \hyperlink{structmx__conn}{mx\-\_\-conn} $\ast$conn)}\label{protocol_8h_a7f08ff74d834d14d6aaf5b6d19b99085}

\item 
\hypertarget{protocol_8h_ac7ec4afbac17b4a2c788784dc68bad09}{int {\bfseries send\-\_\-datastr} (struct \hyperlink{structmx__conn}{mx\-\_\-conn} $\ast$conn)}\label{protocol_8h_ac7ec4afbac17b4a2c788784dc68bad09}

\item 
\hypertarget{protocol_8h_a248f9650f3fac8b3ac1d8f56f3a43822}{int {\bfseries send\-\_\-quit} (struct \hyperlink{structmx__conn}{mx\-\_\-conn} $\ast$conn)}\label{protocol_8h_a248f9650f3fac8b3ac1d8f56f3a43822}

\end{DoxyCompactItemize}


\subsubsection{Подробное описание}
Файл содержащий структуры и функции для работы по протоколу S\-M\-T\-P. 

\subsubsection{Функции}
\hypertarget{protocol_8h_a63b0324a5f0d042dab0ee3c372b73c2b}{\index{protocol.\-h@{protocol.\-h}!domain\-\_\-add@{domain\-\_\-add}}
\index{domain\-\_\-add@{domain\-\_\-add}!protocol.h@{protocol.\-h}}
\paragraph[{domain\-\_\-add}]{\setlength{\rightskip}{0pt plus 5cm}void domain\-\_\-add (
\begin{DoxyParamCaption}
\item[{struct domain\-\_\-set $\ast$}]{domains, }
\item[{char $\ast$}]{new\-\_\-domain\-\_\-name}
\end{DoxyParamCaption}
)}}\label{protocol_8h_a63b0324a5f0d042dab0ee3c372b73c2b}


Adds another domain into domain set if it is not present there and if it is not local domain (M\-Y\-\_\-\-D\-O\-M\-A\-I\-N in \hyperlink{maildir_8h}{maildir.\-h}) 


\begin{DoxyParams}{Аргументы}
{\em domains} & -- список доменов куда нужно добавить \\
\hline
{\em new\-\_\-domain\-\_\-name} & -- имя домена для добавления \\
\hline
\end{DoxyParams}
