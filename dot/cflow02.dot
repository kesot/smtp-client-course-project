digraph map {
rankdir=LR;
ranksep=0.1; nodesep=0.1; defaultdist = 0.1; len = 0.1;
smtp_client_fsm_step->TAILQ_FIRST;
re_match_and_fill_substring->pcre_exec;
re_compile->pcre_compile;
smtp_client_loop->quit_key_pressed;
wait_for_response->parse_response;
smtp_client_fsm_invalid_transition->SMTP_CLIENT_FSM_EVT_NAME;
smtp_client_fsm_step->ELOG;
conn_final->free_connection;
check_dns->ns_initparse;
smtp_client_fsm_step->send_data;
smtp_client_loop->LOG;
send_hello->strlen;
conn_loop->free_connection;
send_mailfrom->send;
connect_to_any_with_timeout->DLOG;
mail_has_rcpts_from_domain->TAILQ_FOREACH;
conn_init->read_all_mail;
connect_with_timeout->connect;
conn_init->ELOG;
parse_response->str_without_new_line;
conn_loop->TAILQ_FOREACH_SAFE;
connect_to_any_with_timeout->connect_with_timeout;
conn_loop->difftime;
conn_loop->delete_mail;
wait_for_response->get_conn_by_socket;
check_dns->ns_sprintrr;
check_dns->ELOG;
re_match->pcre_exec;
re_match_and_alloc_substring->pcre_exec;
send_data->strlen;
smtp_client_fsm_step->send_mailfrom;
check_dns->ns_parserr;
send_rcptto->sprintf;
smtp_client_loop->conn_loop;
conn_loop->TAILQ_FOREACH;
connect_to_any_with_timeout->socket;
send_hello->send;
send_mailfrom->strlen;
send_quit->send;
wait_for_response->recv;
smtp_client_loop->conn_final;
wait_for_response->invalidate_connection;
conn_loop->wait_for_response;
conn_final->TAILQ_FOREACH_SAFE;
mail_has_rcpts_from_domain->rcpt_is_from_domain;
connect_to_any_with_timeout->ELOG;
smtp_client_fsm_invalid_transition->SMTP_CLIENT_FSM_STATE_NAME;
free_connection->close;
conn_final->free_mail_list;
parse_response->time;
conn_loop->TAILQ_EMPTY;
wait_for_response->str_without_new_line;
domain_add->opts_my_domain;
send_rcptto->send;
smtp_client_fsm_step->TAILQ_NEXT;
send_rcptto->strlen;
smtp_client_fsm_step->mail_has_rcpts_from_domain;
domain_add->TAILQ_FOREACH;
wait_for_response->DLOG;
free_domain->TAILQ_REMOVE;
conn_init->calloc;
re_match_and_fill_substring->memcpy;
smtp_client_fsm_step->send_datastr;
send_data->send;
conn_init->TAILQ_FOREACH;
check_dns->strlen;
conn_init->TAILQ_INIT;
check_dns->res_query;
conn_loop->time;
smtp_client_fsm_step->send_quit;
wait_for_response->FD_ZERO;
send_datastr->strlen;
check_dns->re_match_and_fill_substring;
check_dns->strtol;
send_datastr->send;
wait_for_response->poll;
conn_loop->ELOG;
re_compile->ELOG;
connect_to_any_with_timeout->close;
re_init->re_compile;
check_dns->ns_msg_count;
parse_response->smtp_client_fsm_step;
parse_response->ELOG;
free_connection->TAILQ_REMOVE;
conn_init->create_connection;
conn_loop->invalidate_connection;
smtp_client_fsm_step->send_rcptto;
domain_add->TAILQ_INSERT_TAIL;
smtp_client_loop->conn_init;
connect_with_timeout->fcntl;
parse_response->re_match_any;
send_rcptto->rcpt_is_from_domain;
conn_init->TAILQ_INSERT_TAIL;
conn_init->domain_add;
conn_final->free_domain;
wait_for_response->TAILQ_FOREACH;
check_dns->LOG;
re_match_and_alloc_substring->memcpy;
smtp_client_loop->sleep;
smtp_client_fsm_step->DLOG;
smtp_client_fsm_step->smtp_client_fsm_invalid_transition;
smtp_client_fsm_step->smtp_client_fsm_step;
send_quit->strlen;
wait_for_response->ELOG;
conn_loop->LOG;
re_match_any->pcre_exec;
smtp_client_loop->new_mail_exist;
conn_loop->move_mail;
check_dns->DLOG;
send_rcptto->TAILQ_NEXT;
connect_with_timeout->poll;
conn_loop->opts_connection_timeout;
smtp_client_fsm_step->send_hello;
}
