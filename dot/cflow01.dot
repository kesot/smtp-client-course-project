digraph map {
rankdir=LR;
ranksep=0.1; nodesep=0.1; defaultdist = 0.1; len = 0.1;
getch->tcgetattr;
smtp_client_fsm_step->TAILQ_FIRST;
send_quit->strlen;
send_data->send;
keyboard_loop->send;
smtp_client_fsm_invalid_transition->SMTP_CLIENT_FSM_STATE_NAME;
conn_init->TAILQ_FOREACH;
smtp_client_loop->quit_key_pressed;
delete_mail->ELOG;
copy_mail->ELOG;
wait_for_response->parse_response;
smtp_client_fsm_invalid_transition->SMTP_CLIENT_FSM_EVT_NAME;
smtp_client_fsm_step->ELOG;
fork_log->fork;
move_mail->sprintf;
smtp_client_fsm_step->send_data;
conn_final->free_connection;
smtp_client_loop->LOG;
send_hello->strlen;
conn_loop->free_connection;
send_mailfrom->send;
keyboard_listener_fork->exit;
mail_has_rcpts_from_domain->TAILQ_FOREACH;
init->ELOG;
conn_init->ELOG;
keyboard_listener_fork->close;
parse_response->str_without_new_line;
conn_loop->TAILQ_FOREACH_SAFE;
free_mail_list->TAILQ_REMOVE;
keyboard_listener_fork->socketpair;
init->opts_final;
filter_my_mail->copy_mail;
filter_my_mail->TAILQ_REMOVE;
getch->select;
wait_for_response->get_conn_by_socket;
new_mail_exist->closedir;
copy_mail->sprintf;
init->opts_init;
filter_my_mail->move_mail;
new_mail_exist->opendir;
keyboard_listener_final->recv;
read_all_mail->closedir;
free_mail_list->free_mail;
send_data->strlen;
smtp_client_fsm_step->send_mailfrom;
main->final;
smtp_client_loop->conn_final;
read_all_mail->read_mail_file;
maildir_init->strlen;
smtp_client_fsm_step->smtp_client_fsm_invalid_transition;
conn_loop->TAILQ_FOREACH;
send_hello->send;
send_mailfrom->strlen;
send_quit->send;
wait_for_response->recv;
delete_mail->sprintf;
final->re_final;
final->opts_final;
wait_for_response->invalidate_connection;
conn_loop->wait_for_response;
conn_final->TAILQ_FOREACH_SAFE;
read_all_mail->LOG;
keyboard_loop->LOG;
fork_log->socketpair;
keyboard_listener_final->fcntl;
send_rcptto->sprintf;
new_mail_exist->readdir;
free_connection->close;
conn_final->free_mail_list;
parse_response->time;
conn_loop->TAILQ_EMPTY;
wait_for_response->str_without_new_line;
domain_add->TAILQ_INSERT_TAIL;
keyboard_loop->getch;
domain_add->opts_my_domain;
send_rcptto->send;
init->fork_log;
keyboard_listener_fork->ELOG;
smtp_client_fsm_step->TAILQ_NEXT;
send_rcptto->strlen;
send_log->send;
smtp_client_fsm_step->mail_has_rcpts_from_domain;
free_mail_list->TAILQ_FIRST;
domain_add->TAILQ_FOREACH;
init->keyboard_listener_fork;
move_mail->ELOG;
wait_for_response->DLOG;
main->smtp_client_loop;
keyboard_listener_fork->fcntl;
filter_my_mail->opts_my_domain;
conn_init->calloc;
smtp_client_fsm_step->send_datastr;
copy_mail->link;
re_compile->pcre_compile;
filter_my_mail->LOG;
parse_response->smtp_client_fsm_step;
fork_log->log_message;
conn_init->TAILQ_INIT;
log_message->strftime;
conn_loop->time;
smtp_client_fsm_step->send_quit;
wait_for_response->FD_ZERO;
send_datastr->strlen;
log_loop->log_message;
getch->tcsetattr;
conn_loop->invalidate_connection;
maildir_init->opts_maildir_root;
filter_my_mail->free_mail;
read_all_mail->filter_my_mail;
log_message->time;
send_datastr->send;
wait_for_response->poll;
fork_log->exit;
re_compile->ELOG;
close_log->log_message;
conn_init->read_all_mail;
log_message->localtime;
re_init->re_compile;
fork_log->log_loop;
conn_loop->delete_mail;
conn_loop->move_mail;
init->re_init;
maildir_init->sprintf;
filter_my_mail->DLOG;
read_all_mail->TAILQ_INSERT_TAIL;
parse_response->ELOG;
main->init;
free_connection->TAILQ_REMOVE;
conn_init->create_connection;
quit_key_pressed->recv;
keyboard_loop->recv;
smtp_client_fsm_step->send_rcptto;
keyboard_listener_fork->fork;
close_log->send_log;
free_mail->TAILQ_REMOVE;
keyboard_listener_fork->keyboard_loop;
smtp_client_loop->conn_init;
conn_loop->ELOG;
free_domain->TAILQ_REMOVE;
parse_response->re_match_any;
send_rcptto->rcpt_is_from_domain;
final->close_log;
delete_mail->unlink;
conn_init->TAILQ_INSERT_TAIL;
conn_init->domain_add;
conn_final->free_domain;
send_log->log_message;
wait_for_response->TAILQ_FOREACH;
mail_has_rcpts_from_domain->rcpt_is_from_domain;
move_mail->rename;
init->maildir_init;
conn_loop->difftime;
smtp_client_loop->sleep;
final->maildir_final;
keyboard_listener_fork->LOG;
final->keyboard_listener_final;
free_mail->TAILQ_FOREACH_SAFE;
smtp_client_fsm_step->DLOG;
smtp_client_loop->conn_loop;
smtp_client_fsm_step->smtp_client_fsm_step;
wait_for_response->ELOG;
conn_loop->LOG;
re_match_any->pcre_exec;
getch->read;
free_mail_list->TAILQ_EMPTY;
smtp_client_loop->new_mail_exist;
keyboard_loop->ELOG;
filter_my_mail->TAILQ_FOREACH_SAFE;
getch->FD_SET;
read_all_mail->opendir;
fork_log->close;
getch->FD_ZERO;
read_all_mail->ELOG;
send_rcptto->TAILQ_NEXT;
send_log->strlen;
conn_loop->opts_connection_timeout;
log_loop->recv;
smtp_client_fsm_step->send_hello;
read_all_mail->readdir;
close_log->recv;
}
